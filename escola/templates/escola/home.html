{% extends "escola/base.html" %}
<!--
  ~ Developed by Vinicius José Fritzen
  ~ Last Modified 20/04/19 08:56.
  ~ Copyright (c) 2019  Vinicius José Fritzen and Albert Angel Lanzarini
  -->

<!--FIXME Implementar permissões melhoradas-->
{%load dict_key %}
{% block title %} Página Inicial - Medusa II {% endblock %}


{% block conteudo %}

{%if user.profile_escola.template_data.notificacao_count > 0 %}

<article class="container">

        <h2>Notificações</h2>
    <div class="list-group">
        {% for noti in user.profile_escola.template_data.notificacoes%}
            <a href="{% if noti.link%}{{noti.link}}{%else%}#{%endif%}" class="list-group-item list-group-item-action">
                <div class="d-flex w-100 justify-content-between">
                    <h5 class="mb-1">{{noti.title}}</h5>
                    <small>{{noti.dataCriado|timesince}} ago</small>
                </div>
                <p class="mb-1">{{noti.msg}}</p>
            </a>
        {%endfor%}
    </div>
</article> <br/>
{%endif%}


{% if request.user.profile_escola.is_aluno%}
<article  class="container">
    <h2>Horario:</h2>
{% mostra_horario_proprio user %}
</article> <br/>

<article  class="container">
    <h2>Proximas tarefas</h2>
    {%if perms.escola.can_add_tarefa%}
        <a href="{% url 'escola:add-tarefa' turma.pk %}">Adicionar Tarefa</a>
    {%endif%}
    <div class="table-responsive">
    <table class="table table-striped">
    <tr>
        <th>Titulo</th>
        <th>Materia</th>
        <th>Tipo</th>
        <th>Descrição</th>
        <th>Data de Entrega</th>
        <th>Concluido</th>
        <th>Marcar como concluido</th>
        {%if perms.escola.can_edit_cargo%}
        <th></th>
        {%endif%}
        {%if perms.escola.can_delete_cargo%}
        <th></th>
        {%endif%}
    </tr>
    {%for tarefa in tarefas%}
        <tr>
            <th>{{tarefa.0.titulo}}</th>
            <th>{{tarefa.0.materia}}</th>
            <th>{{tarefa.0.get_tipo_display}}</th>
            <th>{{tarefa.0.descricao|truncatechars:30}}</th>
            <th>{{tarefa.0.deadline}}</th>
            <th>{{tarefa.1.completo|yesno:"Sim,Não,Hmmm:("}}</th>
            <th><a href="{% url 'escola:concluir-tarefa' tarefa.0.pk %}">CONCLUIR</a></th>
            {%if perms.escola.can_edit_cargo%}
            <th><a href="{% url 'escola:edit-tarefa' tarefa.0.pk %}">EDIT</a></th>
            {%endif%}
            {%if perms.escola.can_delete_cargo%}
            <th><a href="{% url 'escola:delete-tarefa' tarefa.0.pk %}">DELETE</a></th>
            {%endif%}
        </tr>
    {%endfor%}
    </table></div>
</article> <br/>
<article  class="container">
    <h2>Proximas Provas:</h2>
    Não Implementado
</article> <br/>
{%endif%}


{% endblock %}

{% block scripts %}
{% endblock %}
